<% content_for :javascript do -%>
  <%= javascript_include_tag "jquery/jquery.slider.js" -%>
  <%= javascript_include_tag "groups/edit" -%>
<% end -%>

<% form_for group, :url => device_groups_path(group) do |f| %>
  <div>
    <h3>Group Details</h3>
    
    <div class="field">
      <%= f.label :name %>
      <%= f.text_field :name %>
      <%= error_message_on group, :name, :prepend_text => '* Name ' %>
    </div>
    
    <div class="field">
      <%= f.label :parent %>
      <%= f.select :parent_id, nested_set_options(current_user.groups) {|i| "#{'-' * i.level} #{i.name}" }, :include_blank => 'Root' %>
      <%= error_message_on group, :parent_id, :prepend_text => '* Parent ' %>
    </div>
    
  </div>

  <% proxy = group.grade_proxy -%>
  <h3>Group Parameters</h3>
  <p>Values shown here are [key] [pass] - [fail]</p>
  <p>The values that are reversed (aka, less is fail, more is pass) are <strong><%= DeviceGroup::Grade::PARAM_REVERSED.keys.join(", ") -%></strong></p>
  <% DeviceGroup::Grade::VALID_PARAMS.each do |param| -%>
    <div>
      <span><%= param.to_s.humanize.titleize -%></span> <span class="pass"></span> - <span class="fail"></span>
      <div id="<%= param -%>_events_slider" class="<%= DeviceGroup::Grade::TIME_PARAMS[param] ? "time-slider" : "slider" -%> <%= DeviceGroup::Grade::PARAM_REVERSED[param] ? "reversed" : "" -%>">
        <%= hidden_field_tag "group[grading][#{param}][fail]", proxy.send(param)[:fail], :class => "fail" -%>
        <%= hidden_field_tag "group[grading][#{param}][pass]", proxy.send(param)[:pass], :class => "pass" -%>
      </div>
    </div>
  <% end -%>

  <div class="buttons">
    <%= link_to 'Cancel', device_groups_path %>
    <%= submit_tag 'Save', :class => 'button' %> 
  </div>

  <div class="clear"></div>
<% end %>
